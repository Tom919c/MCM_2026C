强调：**所有涉及“历史”的特征，都严禁使用“未来数据”（即计算第 T 周特征时，不能用到 T+1 周之后的信息）。**

### 特征工程需求表

#### 1. 选手静态特征 (Static Celebrity Features)
*用于捕捉名人的固有粉丝基础（Base Popularity）。*

| 字段名                | 类型  | 构造逻辑/说明                                                                                        | 备注                                             |
| :----------------- | :-- | :--------------------------------------------------------------------------------------------- | :--------------------------------------------- |
| `is_male`          | 0/1 | 名人为男性=1，女性=0                                                                                   | 核心人口统计学特征                                      |
| `age`              | 数值  | 赛季开始时的年龄                                                                                       | 建议保留原始数值                                       |
| `age_squared`      | 数值  | $Age^2$                                                                                        | 用于捕捉非线性关系（如：观众偏爱极年轻或极年长的选手）                    |
| `age_bucket_young` | 0/1 | Age < 25 (阈值可调)                                                                                | 独热编码 A                                         |
| `age_bucket_mid`   | 0/1 | 25 <= Age <= 50                                                                                | 独热编码 B                                         |
| `age_bucket_old`   | 0/1 | Age > 50                                                                                       | 独热编码 C                                         |
| `industry_{Type}`  | 0/1 | 将 `celebrity_industry` 归类为 Top 5-7 类并做独热编码 | 需人工清洗                               |
| `is_international` | 0/1 | `homecountry` 不是 "United States" = 1 | 区分美国本土 vs 国际选手 |
| `log_us_state_pop` | 数值 | **仅当 `is_international` = 0 时**，填入选手所在州的 $log_{10}(\text{人口数})$。**若为国际选手，此项填 0。** | **核心修正**：隔离美国选手的“州内基本盘”效应 |

对于 `age` 和 `age_squared`，必须进行中心化：
$$age_{centered} = age - \mu_{age}$$

职业归类映射表：

| Original Occupation      | Category                                 |
| ------------------------ | ---------------------------------------- |
| Actor/Actress            | Performing Arts & Entertainment          |
| Athlete                  | Sports & Physical Performance            |
| Model                    | Fashion, Beauty & Modeling               |
| Singer/Rapper            | Music & Dance                            |
| TV Personality           | Performing Arts & Entertainment          |
| News Anchor              | Media, News & Communication              |
| Sports Broadcaster       | Sports & Physical Performance            |
| Beauty Pagent            | Fashion, Beauty & Modeling               |
| Racing Driver            | Sports & Physical Performance            |
| Magician                 | Performing Arts & Entertainment          |
| Radio Personality        | Performing Arts & Entertainment          |
| Comedian                 | Performing Arts & Entertainment          |
| Entrepreneur             | Business, Controversial & Special Roles  |
| Politician               | Public Service & Specialized Professions |
| Astronaut                | Public Service & Specialized Professions |
| Fashion Designer         | Performing Arts & Entertainment          |
| Social Media Personality | Media, News & Communication              |
| Motivational Speaker     | Music & Dance                            |
| Military                 | Public Service & Specialized Professions |
| Journalist               | Media, News & Communication              |
| Musician                 | Music & Dance                            |
| Producer                 | Performing Arts & Entertainment          |
| Fitness Instructor       | Sports & Physical Performance            |
| Con artist               | Business, Controversial & Special Roles  |
| Conservationist          | Public Service & Specialized Professions |
| Social media personality | Media, News & Communication              |

#### 2. 职业舞者特征 (Pro Partner Features)
*用于捕捉“名师出高徒”效应及舞者自身的粉丝群。*

| 字段名 | 类型 | 构造逻辑/说明 | 备注 |
| :--- | :--- | :--- | :--- |
| `pro_id` | 索引 | 给每位职业舞者分配唯一 ID (1, 2, 3...) | 用于贝叶斯模型的**随机效应 (Random Effects)** |
| `pro_prev_wins` | 数值 | 该舞者在**本赛季之前**获得的冠军总次数 | 反映舞者的历史统治力 |
| `pro_avg_rank` | 数值 | 该舞者在**本赛季之前**的历史平均排名 | 若为新舞者，填所有舞者的平均值 |
| `same_sex_pair` | 0/1 | 名人与舞者性别相同 = 1 | 捕捉特殊组合的社会反响 |

#### 3. 动态表现特征 (Dynamic Performance Features)
*每周更新，用于反映当周的技术表现。*

| 字段名               | 类型 | 构造逻辑/说明                                                | 备注                                   |
| :------------------- | :--- | :----------------------------------------------------------- | :------------------------------------- |
| `z_score`            | 数值 | $\frac{\text{个人分} - \text{当周全员均分}}{\text{当周标准差}}$ | **核心特征**：跨赛季、跨周的可比表现分 |
| `score_trend`        | 数值 | $\text{本周 z_score} - \text{上周 z_score}$                  | 第一周填 0；捕捉“进步”叙事             |
| `is_top_score`       | 0/1  | 本周 `raw_score` 为全场最高（或并列最高） = 1                | 领跑者光环效应                         |
| `perfect_score`      | 0/1  | 是否获得满分（如 30/30 或 40/40）                            | 满分表演通常有额外话题性               |
| `judge_score_stddev` | 数值 | 计算当周选手获得的所有评委评分的**标准差**                   | **新增**：量化评委间的“争议度”         |

#### 4. 存活与历史轨迹特征 (Survival & History)
*每周更新，用于捕捉“粉丝粘性”和“逆风翻盘”信号。*

| 字段名 | 类型 | 构造逻辑/说明 | 备注 |
| :--- | :--- | :--- | :--- |
| `times_in_bottom` | 数值 | 截止到本周前，累计进入“倒数两名”的次数 | 濒死次数越多，粉丝可能越疲劳 |
| `cumulative_avg_score` | 数值 | 截止到本周前的赛季平均分 | 选手的整体实力定位 |
| `teflon_factor` | 0/1 | **上一周**评委分排倒数前2，但结果为 **Safe** | **最强特征**：得分低但没死，说明该周粉丝票极高 |
| `weeks_survived` | 数值 | 当前是第几周 (t) | 随着赛程深入，粉丝基础会固化 |

#### 5. 赛制与环境特征 (Context Features)
*用于控制模型在不同规则下的行为。*

| 字段名 | 类型 | 构造逻辑/说明 | 备注 |
| :--- | :--- | :--- | :--- |
| `season_era` | 类别/数值 | 1: 早期(S1-10), 2: 中期(S11-20), 3: 社媒期(S21+) | 也可以直接用 `season_id` |
| `rule_method` | 0/1 | 0 = 排名法 (Rank Method)<br>1 = 百分比法 (Percent Method) | **这不在回归中使用，但在似然函数计算淘汰逻辑时必选** |
| `judge_save_active` | 0/1 | 该赛季是否有“评委拯救环节” (通常 S28+) | 同样用于调整淘汰逻辑 |

---

### 给数据团队的额外处理提示 (Data Processing Tips)

1.  **缺失值处理 (N/A):**
    
    *   如果选手自身原因未参赛（如生病缺席）导致  `score` 是 N/A 且 `results` 显示已淘汰：直接在当周及之后的数据中移除该选手。
    *   如果选手自身原因未参赛（如生病缺席）导致 `score` 是 N/A ，但选手未淘汰：以该选手本赛季历史均分赋值。
    *   只有3个评委是第4名评委的分值会标记为N/A,(例如week1_judge4_score表示第一周第4名评委)，只计算前三名评委的打分，并注意均值计算的变化
    *   如果是比赛只进行了前几周就结束，那么后续周的打分数值也会全部标记为N/A，该种情况要加以识别并做合适的处理
    
2.  **数据标准化:**
    
    *   除 `z_score` 外，对人口对数 `log_home_pop` 和年龄 `age` 也进行标准化（减均值除方差），对 MCMC 采样收敛非常有帮助。
    
3.  **最终输出格式:**
    * 我们需要一个 **Long Format (长格式)** 的表格。
    
    * **主键:** `Season_ID`, `Week_ID`, `Celebrity_ID`。
    
    * 每一行代表：某位选手在某一周的状态。
    
      长格式表格定义如下：
    
      我们将数据格式定义为 **“长表（Long Format）”**，即：**一行（Row）代表“一位选手在某一赛季某一周”的所有信息。**
    
      ###  核心字段清单（按模块划分）
    
      #### 1. 唯一标识符与索引 (Primary Keys & IDs)
    
      *用于分组聚合和嵌入层 (Embedding)*
    
      - `season_id`: 整数 (1-34)。
      - `week_id`: 整数 (1-12)。
      - `celebrity_id`: 选手的唯一编码（将姓名转为 ID）。
      - `pro_id`: 职业舞者的唯一编码。
    
      #### 2. 模型目标/标签 (Ground Truth Labels)
    
      *注意：这些是观测值，用于训练时的似然估计。*
    
      - `result_status`: 类别型。
        - `0`: **Safe** (安全进入下一周)
        - `1`: **Eliminated** (当周被淘汰)
      - `elimination_count`: **[关键]** 该周总共淘汰了几个人（通常为1，有时为2，有时为0）。
      - `placement_final`: 该选手最终赛季排名 (1, 2, 3...)。
    
      #### 3. 特征
    
      所有特征
    
      #### 4. 已知合并参数 (Known Constants)
    
      *用于在 Loss Function 中还原节目规则。*
    
      - `judge_score_raw`: 选手本周原始总分。
    
      - `judge_rank`: 选手本周在所有选手中的排名（1为最高分）。
    
      - `judge_percent`: 选手本周得分占全场总分的比例。
    
      - `voting_rule_type`: 0 = 排名法, 1 = 百分比法。
    
      - `judge_save_active`: 0/1 (本周是否有“评委拯救”机制)。
    
        “评委拯救”机制指:
    
        - 首先使用评委评分与粉丝投票的组合结果，确定排名最低的两位选手；
        - 然后在直播节目中，由评委投票决定这两位中哪一位被淘汰。
        - 28季及以后均有该机制，28以前无该机制