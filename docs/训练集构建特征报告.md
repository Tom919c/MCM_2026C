# train_data 数据验证报告

## 对照文档：d:\Code\VSCode\MCM_2026C\docs\训练特征构造.md

### ✅ 1. 维度信息

| 字段 | 文档要求 | 实际值 | 状态 |
|------|---------|--------|------|
| n_obs | int: 观测总数 | 2778 | ✅ |
| n_weeks | int: 周总数 | 335 | ✅ |
| n_celebs | int: 名人总数 | 408 | ✅ |
| n_pros | int: 职业舞者总数 | 54 | ✅ |
| n_seasons | int: 赛季总数 | 34 | ✅ |

### ✅ 2. 索引数组

| 字段 | 文档要求 | 实际值 | 状态 |
|------|---------|--------|------|
| celeb_idx | shape: [n_obs], dtype: int32 | shape=(2778,), dtype=int32, range=[0, 407] | ✅ |
| pro_idx | shape: [n_obs], dtype: int32 | shape=(2778,), dtype=int32, range=[0, 53] | ✅ |
| week_idx | shape: [n_obs], dtype: int32 | shape=(2778,), dtype=int32, range=[0, 334] | ✅ |
| season_idx | shape: [n_obs], dtype: int32 | shape=(2778,), dtype=int32, range=[0, 33] | ✅ |

### ✅ 3. 特征矩阵

#### 3.1 X_celeb (名人特征)

**文档要求的特征列表：**
1. is_male
2. age
3. age_squared
4. age_centered
5. age_bucket_young
6. age_bucket_mid
7. age_bucket_old
8. industry_Business, Controversial & Special Roles
9. industry_Fashion, Beauty & Modeling
10. industry_Media, News & Communication
11. industry_Music & Dance
12. industry_Performing Arts & Entertainment
13. industry_Public Service & Specialized Professions
14. industry_Sports & Physical Performance
15. is_international
16. log_us_state_pop

**实际特征：** 16 个，完全匹配 ✅

**数据类型：** float32 ✅

**标准化检查：**
- ✅ age: mean=-0.000, std=1.000 (标准化)
- ✅ age_squared: mean=0.000, std=1.000 (标准化)
- ✅ age_centered: mean=0.000, std=1.000 (标准化)
- ✅ log_us_state_pop: mean=-0.000, std=1.000 (标准化) **已修复！**
- ✅ 二值特征未标准化 (is_male, age_bucket_*, industry_*, is_international)

#### 3.2 X_pro (职业舞者特征)

**文档要求的特征列表：**
1. pro_id
2. is_male

**实际特征：** 2 个，完全匹配 ✅

**数据类型：** float32 ✅

**标准化检查：**
- ✅ pro_id: mean=-0.000, std=1.000 (标准化)
- ✅ is_male: mean=0.481, std=0.500 (未标准化，二值特征) **已修复！**

#### 3.3 X_obs (观测级特征)

**文档要求的特征列表：**
1. pro_prev_wins
2. pro_avg_rank
3. same_sex_pair
4. z_score
5. score_trend
6. is_top_score
7. perfect_score
8. judge_score_stddev
9. times_in_bottom
10. cumulative_avg_score
11. teflon_factor
12. weeks_survived
13. season_era
14. rule_method
15. judge_save_active

**实际特征：** 15 个，完全匹配 ✅

**数据类型：** float32 ✅

**标准化检查：**
- ✅ 连续特征已标准化 (均值≈0, 标准差≈1):
  - pro_prev_wins, pro_avg_rank, z_score, score_trend
  - judge_score_stddev, times_in_bottom, cumulative_avg_score
  - weeks_survived, season_era
- ✅ 二值特征未标准化:
  - same_sex_pair, is_top_score, perfect_score, teflon_factor
  - rule_method, judge_save_active

### ✅ 4. 淘汰规则相关数据

| 字段 | 文档要求 | 实际值 | 状态 |
|------|---------|--------|------|
| judge_score_pct | shape: [n_obs], float32 | shape=(2778,), dtype=float32, range=[0.000, 1.000] | ✅ |
| judge_rank_score | shape: [n_obs], float32 | shape=(2778,), dtype=float32, range=[0.000, 1.000] | ✅ |

### ✅ 5. 周级结构信息

**week_data 长度：** 335 周 ✅

**每周数据结构：**
- ✅ obs_mask: bool array
- ✅ n_contestants: int
- ✅ n_eliminated: int
- ✅ eliminated_mask: bool array
- ✅ rule_method: int (0=排名法, 1=百分比法)
- ✅ judge_save_active: bool
- ✅ season: int (赛季索引)
- ✅ week: int (周数)

### ✅ 6. 数据完整性

- ✅ 无 NaN 值 (X_celeb: 0, X_pro: 0, X_obs: 0)
- ✅ 索引范围正确 (所有索引都在有效范围内)

## 总结

**所有要求均已满足！** ✅✅✅

### 修复的问题：
1. ✅ 舞者性别 bug (大小写问题) - 已修复
2. ✅ 州人口数据加载失败 (路径问题) - 已修复
3. ✅ 特征数量从 19 个减少到 15 个 (移除了不应该存在的特征)

### 关键指标：
- 数据类型：所有特征矩阵均为 float32
- 标准化：连续特征均值≈0，标准差≈1；二值特征保持原值
- 特征数量：X_celeb(16), X_pro(2), X_obs(15)
- 数据完整性：无 NaN 值，索引范围正确
